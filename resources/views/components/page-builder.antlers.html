<section class="max-w-8xl mx-auto px-10 py-24">
    {{ page_builder }}

        {{ if type == "heading" }}
            <h1 class="font-serif text-[54px] leading-none text-center">{{ heading_text }}</h1>
        {{ /if }}

        {{ if type == "content_block" }}
            <div class="flex items-center nth-of-type-1:flex-row-reverse nth-of-type-3:flex-row-reverse nth-of-type-5:flex-row-reverse gap-8 justify-between py-24">
                <div class="flex-1">
                    <div class="font-hand text-2xl mb-2">{{ $eyebrow_text }}</div>
                    <div class="text-[44px] leading-tight font-light font-serif prose">
                        {{ block_content }}
                    </div>
                </div>
                <div class="w-[340px] flex items-center">
                    <img src="{{ illustration:url }}" alt="{{ illustration:alt }}" />
                </div>
            </div>
        {{ /if }}

        {{ if type == "gallery" }}
            <div
                x-data="{
                    hoveredIndex: null,
                    baseRotations: [],
                    baseShifts: [],
                    init() {
                        const rotations = [-4, -3, -2, -1, 0, 1, 2, 3, 4];
                        const shifts = [-8, -6, -4, -2, 0, 2, 4, 6, 8];
                        const images = this.$el.querySelectorAll('.gallery-image');
                        images.forEach(() => {
                            this.baseRotations.push(rotations[Math.floor(Math.random() * rotations.length)]);
                            this.baseShifts.push(shifts[Math.floor(Math.random() * shifts.length)]);
                        });
                    },
                    handleMouseEnter(index) {
                        this.hoveredIndex = index;
                    },
                    handleMouseLeave() {
                        this.hoveredIndex = null;
                    },
                    getTransform(index) {
                        const baseRotation = this.baseRotations[index] || 0;
                        const baseShift = this.baseShifts[index] || 0;

                        if (this.hoveredIndex === null) {
                            return `rotate(${baseRotation}deg) translateY(${baseShift}px)`;
                        }

                        const hovered = this.hoveredIndex;
                        const distance = index - hovered;
                        const absDistance = Math.abs(distance);

                        if (distance === 0) {
                            return 'scale(1.15) translateY(-20px)';
                        }

                        const spread = absDistance * 60;
                        const direction = distance > 0 ? 1 : -1;
                        const rotation = direction * Math.min(absDistance * 2, 8);

                        return `translateX(${direction * spread}px) rotate(${rotation}deg) scale(0.95)`;
                    },
                    getZIndex(index) {
                        if (this.hoveredIndex === null) return 1;
                        return index === this.hoveredIndex ? 10 : 1;
                    },
                    isHovered(index) {
                        return this.hoveredIndex === index;
                    }
                }"
                class="flex items-center justify-center gap-8 py-24 relative"
            >
                {{? $imgIndex = 0 ?}}
                {{ gallery_images }}
                    <div
                        class="gallery-image relative"
                        :data-index="{{ $imgIndex }}"
                        :style="`
                            transform: ${getTransform({{ $imgIndex }})};
                            z-index: ${getZIndex({{ $imgIndex }})};
                            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), z-index 0s;
                        `"
                        @mouseenter="handleMouseEnter({{ $imgIndex }})"
                        @mouseleave="handleMouseLeave()"
                    >
                        <div
                            class="rounded-3xl overflow-hidden -mx-10 transition-all duration-500"
                            :class="isHovered({{ $imgIndex }}) ? 'shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] ring-4 ring-white/20' : 'shadow-2xl'"
                        >
                            <img
                                src="{{ url }}"
                                alt="{{ alt }}"
                                class="rounded-3xl h-[400px] w-[240px] object-cover cursor-pointer transition-all duration-500"
                                :class="isHovered({{ $imgIndex }}) ? 'brightness-105' : ''"
                            />
                        </div>
                    </div>
                    {{? $imgIndex = $imgIndex + 1 ?}}
                {{ /gallery_images }}
            </div>
        {{ /if }}

        {{ if type == "section_break" }}
            {{ icon:url }}
        {{ /if }}

    {{ /page_builder }}
</section>
